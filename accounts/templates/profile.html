{% extends 'base.html' %} 

{% block page_title %}{{ user }}'s Profile{% endblock %} 

{% block content %}
<div class="col-12 profile-wrapper">
    <p class="col-12 text-center"><span class="boldtext">Username: </span>{{ user.uprofile }}</p>
    <p class="col-12 text-center"><span class="boldtext">First name: </span>{{ user.first_name }}</p>
    <p class="col-12 text-center"><span class="boldtext">Last name: </span>{{ user.last_name }}</p>
    <p class="col-12 text-center"><span class="boldtext">Email: </span>{{ user.email }}</p>
    <p class="col-12 text-center"><span class="boldtext">Location: </span>{{ user.uprofile.location }}</p>
    <p class="col-12 text-center"><span class="boldtext">Rent? </span>{{ user.uprofile.want_to_rent }}</p>
    {% if user == request.user or request.user.is_superuser %}
        <div class=" col-12 text-center">
            <a href="{% url 'update_profile' %}" class="btn btn-info">Edit my profile</a>
        </div> 
    {% endif %}    
    <p class="col-12 text-center"><span class="boldtext">Books: </span>
</div>
{% for user_post in user_posts %}
    <div class="col-md-6 col-lg-4 col-xl-2 product-wrapper" id="profile-products">
        <h3 class="text-center product-header"><a href="{% url 'product_detail' user_post.id %}">{{ user_post.title }}</a></h3>
        <div class="text-center wrapper-product-img">
            <a class="product-link" href="{% url 'product_detail' user_post.id %}">
                <img class="product-img" src="/media/{{ user_post.image }}">
            </a>
        </div>
        <p class="col-12 text-center"><span class="boldtext">By: </span>{{ user_post.author }} </p>
        <p class="col-12 text-center"><span class="boldtext">Condition: </span>{{ user_post.condition_of_book }} </p>
        <p class="col-12 text-center"><span class="boldtext">Location: </span>{{ user_post.location }} </p>
         {% if product.is_for_rent == True and product.id in cart_ids%}   
            <div class="row rent-sale-background">
                <div class="col-md-6 rent-sale-box">
                    <p><span class="boldtext">For Rent: €</span> {{product.rentprice_per_week}} p/w</p>
                    </div>
                <div class="col-md-6 rent-sale-button">
                    <form class="margin-bottom" action='{% url "remove" %}' method="POST" id="remove_from_cart_form-{{ forloop.counter }}">
                        {% csrf_token %}
                        <input type="hidden" name="product_id" value="{{ item.product.id }}"/>
                        <button class="btn btn-info">Remove from cart</button>
                    </form> 
                </div>
            </div>
            {% elif product.is_for_rent == True and user != superuser and user != product.provider %} 
            <div class="row rent-sale-background">
                <div class="col-md-6 rent-sale-box">
                    <p><span class="boldtext">For Rent:<br> €</span> {{product.rentprice_per_week}} p/w</p>
                </div>
                <div class="col-md-6 rent-sale-button">
                    <form class="text-center margin-bottom" action="{% url 'add_to_cart' product.id %}" method="post" id="add_to_cart_form-{{ forloop.counter }}">
                        {% csrf_token %}
                        <span class="input-group-btn">
                            <button id="add_to_cart_button-{{ forloop.counter }}" class="btn btn-info" type="submit" >Add to cart</button>
                        </span>
                    </form> 
                </div> 
            </div>       
            {% endif %}
            {% if product.is_for_sale == True and user != product.provider%}
            <div class="row rent-sale-background">
                <div class="col-md-6 rent-sale-box">
                    <p><span class="boldtext">For Sale:<br>€</span> {{product.saleprice}}</p>
                </div>
                <div class="col-md-6 rent-sale-button text-center margin-bottom">
                    <a href="{% url 'user_contact_form' %}" class="btn btn-info">Contact Seller</a>
                </div>
            </div>
            {% endif %}
        <p class="col-12 text-center"><span class="boldtext">Summary: </span>{{ user_post.summary|truncatewords:10}}<a href="{% url 'product_detail' user_post.id %}" id="summary-more"> More</a></p>
    </div>
{% endfor %}

{% endblock %}

